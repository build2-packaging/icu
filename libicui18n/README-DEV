This document describes how libicui18n was packaged for build2. In particular,
this understanding will be useful when upgrading to a new upstream version.
See ../README-DEV for general notes on ICU packaging.

Symlink the required upstream files into libicui18n/i18n:

$ mkdir -p libicui18n/i18n
$ pushd libicui18n/i18n
$ ln -s ../../../upstream/icu4c/source/i18n/*.{cpp,h} .
$ mkdir unicode
$ cd unicode
$ ln -s ../../../../upstream/icu4c/source/i18n/unicode/*.h .
$ popd

1) Fix Clang 10 compilation errors:

  $ mv libicui18n/i18n/stsearch.cpp libicui18n/i18n/stsearch.cpp.orig
  $ cp libicui18n/i18n/stsearch.cpp.orig libicui18n/i18n/stsearch.cpp

  $ mv libicui18n/i18n/olsontz.cpp libicui18n/i18n/olsontz.cpp.orig
  $ cp libicui18n/i18n/olsontz.cpp.orig libicui18n/i18n/olsontz.cpp

  $ mv libicui18n/i18n/vtzone.cpp libicui18n/i18n/vtzone.cpp.orig
  $ cp libicui18n/i18n/vtzone.cpp.orig libicui18n/i18n/vtzone.cpp

  $ mv libicui18n/i18n/rbtz.cpp libicui18n/i18n/rbtz.cpp.orig
  $ cp libicui18n/i18n/rbtz.cpp.orig libicui18n/i18n/rbtz.cpp

  $ mv libicui18n/i18n/dtitvfmt.cpp libicui18n/i18n/dtitvfmt.cpp.orig
  $ cp libicui18n/i18n/dtitvfmt.cpp.orig libicui18n/i18n/dtitvfmt.cpp

  $ mv libicui18n/i18n/basictz.cpp libicui18n/i18n/basictz.cpp.orig
  $ cp libicui18n/i18n/basictz.cpp.orig libicui18n/i18n/basictz.cpp

  $ mv libicui18n/i18n/fmtable.cpp libicui18n/i18n/fmtable.cpp.orig
  $ cp libicui18n/i18n/fmtable.cpp.orig libicui18n/i18n/fmtable.cpp

  $ git apply clang10.patch

2) Fix Clang 18 compilation errors:

  $ mv libicui18n/i18n/collationdatareader.cpp libicui18n/i18n/collationdatareader.cpp.orig
  $ cp libicui18n/i18n/collationdatareader.cpp.orig libicui18n/i18n/collationdatareader.cpp

  $ mv libicui18n/i18n/collationdata.h libicui18n/i18n/collationdata.h.orig
  $ cp libicui18n/i18n/collationdata.h.orig libicui18n/i18n/collationdata.h

  $ mv libicui18n/i18n/coll.cpp libicui18n/i18n/coll.cpp.orig
  $ cp libicui18n/i18n/coll.cpp.orig libicui18n/i18n/coll.cpp

  $ mv libicui18n/i18n/gregoimp.cpp libicui18n/i18n/gregoimp.cpp.orig
  $ cp libicui18n/i18n/gregoimp.cpp.orig libicui18n/i18n/gregoimp.cpp

  $ mv libicui18n/i18n/rulebasedcollator.cpp libicui18n/i18n/rulebasedcollator.cpp.orig
  $ cp libicui18n/i18n/rulebasedcollator.cpp.orig libicui18n/i18n/rulebasedcollator.cpp

  $ mv libicui18n/i18n/unicode/calendar.h libicui18n/i18n/unicode/calendar.h.orig
  $ cp libicui18n/i18n/unicode/calendar.h.orig libicui18n/i18n/unicode/calendar.h

  $ git apply clang18.patch

Note that the above patches are produced by the following commands:

$ git diff ><patch-path>
